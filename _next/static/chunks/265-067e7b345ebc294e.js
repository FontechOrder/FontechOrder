"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[265],{1242:function(e,r,n){var t=n(5893),i=(n(7294),n(4184)),a=n.n(i);function o(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function u(e,r){if(null==e)return{};var n,t,i=function(e,r){if(null==e)return{};var n,t,i={},a=Object.keys(e);for(t=0;t<a.length;t++)n=a[t],r.indexOf(n)>=0||(i[n]=e[n]);return i}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)n=a[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}r.Z=function(e){var r=e.children,n=e.className,i=u(e,["children","className"]);return(0,t.jsx)("button",function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){o(e,r,n[r])}))}return e}({className:a()(n,"bg-blue-500","hover:bg-blue-700","text-white","font-bold","py-2","px-4","rounded","focus:outline-none","focus:shadow-outline","disabled:bg-slate-500","disabled:text-slate-400")},i,{children:r}))}},576:function(e,r,n){var t=n(5893),i=(n(7294),n(4184)),a=n.n(i),o=n(1664);function u(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function c(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){u(e,r,n[r])}))}return e}r.Z=function(e){var r=e.isBlank,n=void 0!==r&&r,i=e.className,u=e.title,s=e.path,l=n?{target:"_blank",rel:"noreferrer"}:{};return(0,t.jsx)("div",{className:a()("p-2 text-blue-800 hover:underline",i),children:(0,t.jsx)(o.default,{href:s,children:(0,t.jsx)("a",c({},l,{children:u}))})})}},9151:function(e,r,n){var t=n(5893),i=(n(7294),n(4184)),a=n.n(i);function o(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function u(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){o(e,r,n[r])}))}return e}r.Z=function(e){var r=e.className,n=e.inputProps,i=void 0===n?{}:n,o=e.label,c=e.showError,s=void 0!==c&&c,l=e.errorString,f=void 0===l?"":l;return(0,t.jsxs)("div",{className:"pb-4",children:[(0,t.jsxs)("div",{className:r,children:[(0,t.jsx)("label",{className:"flex-0 mb-2 block text-sm font-bold text-gray-700",children:o}),(0,t.jsx)("input",u({className:"focus:shadow-outline w-full appearance-none rounded border py-2 px-3 leading-tight text-gray-700 shadow focus:outline-none",type:"text"},i))]}),(0,t.jsx)("div",{className:a()("text-body-sm my-1 h-4 text-red-500",s&&f?"opacity-100":"opacity-0"),children:f})]})}},2265:function(e,r,n){n.d(r,{Z:function(){return T}});var t=n(5893),i=n(7294),a=n(4051),o=n.n(a),u=n(5748),c=n(317);function s(e,r,n,t,i,a,o){try{var u=e[a](o),c=u.value}catch(s){return void n(s)}u.done?r(c):Promise.resolve(c).then(t,i)}var l=function(){var e,r=(e=o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,(0,u.w7)(c.lX),e.next=7;break;case 4:return e.prev=4,e.t0=e.catch(0),e.abrupt("return",!1);case 7:return e.abrupt("return",!0);case 8:case"end":return e.stop()}}),e,null,[[0,4]])})),function(){var r=this,n=arguments;return new Promise((function(t,i){var a=e.apply(r,n);function o(e){s(a,t,i,o,u,"next",e)}function u(e){s(a,t,i,o,u,"throw",e)}o(void 0)}))});return function(){return r.apply(this,arguments)}}(),f=n(1242),d=n(9726);function p(e,r,n,t,i,a,o){try{var u=e[a](o),c=u.value}catch(s){return void n(s)}u.done?r(c):Promise.resolve(c).then(t,i)}var h=function(e){var r=e.firebaseAuthUser,n=(0,d.Z)().doRemoveUser,i=function(){var e,r=(e=o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:n();case 3:case"end":return e.stop()}}),e)})),function(){var r=this,n=arguments;return new Promise((function(t,i){var a=e.apply(r,n);function o(e){p(a,t,i,o,u,"next",e)}function u(e){p(a,t,i,o,u,"throw",e)}o(void 0)}))});return function(){return r.apply(this,arguments)}}();return(0,t.jsxs)("div",{className:"flex flex-row items-end",children:[(0,t.jsx)("div",{className:"flex-1 whitespace-pre-wrap break-all pb-2 pr-4 text-right text-white",children:r.email}),(0,t.jsx)(f.Z,{className:"flex-0 py-2 px-2 md:min-w-[64px]",onClick:function(){return i()},children:"\u767b\u51fa"})]})},m=n(1165),v=n(576),b=function(e){var r=e.title,n=e.path;return(0,t.jsx)(v.Z,{className:"m-2 h-5 w-5 overflow-hidden truncate !p-0 hover:no-underline sm:h-auto sm:w-auto sm:overflow-auto md:hover:!underline",title:r,path:n})},y=function(e){var r=e.firebaseAuthUser;return(0,t.jsx)("div",{className:"sticky top-0 z-[99] flex flex-col items-center bg-gray-400",children:(0,t.jsx)("div",{className:"flex w-full items-center justify-center bg-red-400 p-2 lg:max-w-[64rem]",children:(0,t.jsxs)("div",{className:"flex w-full flex-row items-center justify-between",children:[(0,t.jsx)("div",{className:"flex-shrink-1 mr-2 flex flex-row self-end text-right",children:m.M1.map((function(e,r){return(0,t.jsx)(b,{title:e.title,path:e.path},"header_nav_".concat(r))}))}),r&&(0,t.jsx)(h,{firebaseAuthUser:r})]})})})},w=function(e){var r=e.header,n=e.children,i=e.footer;return(0,t.jsxs)("div",{id:"page-content",className:"flex min-w-[20rem] flex-col ",children:[r,(0,t.jsx)("div",{className:"w-full self-center lg:w-[64rem] lg:max-w-[64rem]",children:n}),i]})},x=n(1547),g=n(7633),j=n(1912),O=n(1030);function S(e,r,n,t,i,a,o){try{var u=e[a](o),c=u.value}catch(s){return void n(s)}u.done?r(c):Promise.resolve(c).then(t,i)}function k(e){return function(){var r=this,n=arguments;return new Promise((function(t,i){var a=e.apply(r,n);function o(e){S(a,t,i,o,u,"next",e)}function u(e){S(a,t,i,o,u,"throw",e)}o(void 0)}))}}var U=function(){var e=(0,x.Z)(),r=e.isFirst,n=e.firebaseAuthUser,t=(0,O.Z)(),a=t.isLoading,u=t.setIsLoading,c=t.isLoadingHandler,s=(0,d.Z)(),l=s.doUpdateUser,f=s.doRemoveUser,p=s.isInit,h=s.userDoc,m=i.useCallback((function(e){(function(){var r=k(o().mark((function r(){var t,i;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,t=(0,j.EA)(null===n||void 0===n?void 0:n.email)){r.next=4;break}throw new Error("not fontech email");case 4:return r.next=6,(0,g.Z)({path:"users/"+t});case 6:i=r.sent,l(i),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(0),f();case 13:e();case 14:case"end":return r.stop()}}),r,null,[[0,10]])})));return function(){return r.apply(this,arguments)}})()()}),[n,l,f]),v=i.useCallback((function(){c(m)}),[c,m]),b=i.useMemo((function(){return r||p}),[r,p]);i.useEffect((function(){b&&v()}),[b,v]);var y=i.useCallback((function(e){(function(){var r=k(o().mark((function r(){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,(0,j.F4)(null===n||void 0===n?void 0:n.email);case 3:if(r.sent){r.next=6;break}throw new Error("setUserFireStoreError");case 6:return r.next=8,new Promise((function(e){m((function(){return e()}))}));case 8:r.next=12;break;case 10:r.prev=10,r.t0=r.catch(0);case 12:e();case 13:case"end":return r.stop()}}),r,null,[[0,10]])})));return function(){return r.apply(this,arguments)}})()()}),[n,m]),w=i.useCallback((function(){c(y)}),[c,y]);return{isInit:b,isLoading:a,setIsLoading:u,createFirestoreUser:w,getUserDocFromUser:v,userDoc:h,firebaseAuthUser:n}},A=n(4231),P=n(2175),N=n(9151);function I(e,r,n,t,i,a,o){try{var u=e[a](o),c=u.value}catch(s){return void n(s)}u.done?r(c):Promise.resolve(c).then(t,i)}var E=function(){var e,r=(e=o().mark((function e(r){var n,t,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.email,t=r.password,e.next=3,(0,u.e5)(c.lX,n,t);case 3:return i=e.sent,a=i.user,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})),function(){var r=this,n=arguments;return new Promise((function(t,i){var a=e.apply(r,n);function o(e){I(a,t,i,o,u,"next",e)}function u(e){I(a,t,i,o,u,"throw",e)}o(void 0)}))});return function(e){return r.apply(this,arguments)}}(),Z=n(4832);function C(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function M(e,r,n,t,i,a,o){try{var u=e[a](o),c=u.value}catch(s){return void n(s)}u.done?r(c):Promise.resolve(c).then(t,i)}function D(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function _(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,i,a=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(t=n.next()).done)&&(a.push(t.value),!r||a.length!==r);o=!0);}catch(c){u=!0,i=c}finally{try{o||null==n.return||n.return()}finally{if(u)throw i}}return a}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return C(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var L,q=[{id:Z.Wq.email,label:"Email*",type:"text",placeholder:"name@example.com"},{id:Z.Wq.password,label:"\u5bc6\u78bc*",type:"password",placeholder:"\u8acb\u8f38\u5165\u60a8\u7684\u5bc6\u78bc"}],F=(D(L={},Z.Wq.email,""),D(L,Z.Wq.password,""),L),R=A.Ry().shape({email:A.Z_().email("\u7121\u6548\u7684\u96fb\u5b50\u90f5\u4ef6").required("\u672c\u6b04\u4f4d\u70ba\u5fc5\u586b"),password:A.Z_().required("\u672c\u6b04\u4f4d\u70ba\u5fc5\u586b")}),W=function(){var e=(0,d.Z)().doInitUserManager,r=_(i.useState(!1),2),n=r[0],a=r[1],u=_(i.useState(""),2),c=u[0],s=u[1],l=i.useCallback((function(r,n){(function(){var t,i=(t=o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,E({email:r[Z.Wq.email],password:r[Z.Wq.password]});case 3:if(t.sent){t.next=6;break}throw new Error("user not found");case 6:e(),t.next=17;break;case 9:return t.prev=9,t.t0=t.catch(0),s("Login failed"),t.next=14,(0,j._v)(2e3);case 14:return s(""),a(!1),t.abrupt("return");case 17:n();case 18:case"end":return t.stop()}}),t,null,[[0,9]])})),function(){var e=this,r=arguments;return new Promise((function(n,i){var a=t.apply(e,r);function o(e){M(a,n,i,o,u,"next",e)}function u(e){M(a,n,i,o,u,"throw",e)}o(void 0)}))});return function(){return i.apply(this,arguments)}})()()}),[e]),p=i.useCallback((function(e){n||(a(!0),l(e,(function(){a(!1)})))}),[n,l]),h=(0,P.TA)({initialValues:F,validationSchema:R,onSubmit:p});return(0,t.jsx)("div",{children:(0,t.jsxs)("form",{className:"mb-4 rounded bg-white px-8 pt-6 pb-8 shadow-md",onSubmit:h.handleSubmit,children:[(0,t.jsx)("div",{children:(0,t.jsx)("div",{className:"flex-1 md:pr-3",children:q.map((function(e){return(0,t.jsx)(N.Z,{inputProps:{id:e.id,name:e.id,placeholder:e.placeholder,type:e.type,onChange:h.handleChange,value:h.values[e.id]},label:e.label,showError:!(!h.touched[e.id]||!h.errors[e.id]),errorString:h.errors[e.id]},"firebase-login-input-".concat(e.id))}))})}),(0,t.jsx)(f.Z,{type:"submit",children:"\u78ba\u8a8d\u9001\u51fa"}),c&&(0,t.jsx)("p",{children:c})]})})},T=function(e){var r=e.children,n=U(),a=n.isInit,o=n.isLoading,u=n.createFirestoreUser,c=n.firebaseAuthUser,s=n.userDoc,l=i.useMemo((function(){return a?(0,t.jsx)("div",{children:"Init..."}):o?(0,t.jsx)("div",{children:"Loading..."}):c?s?r:(0,t.jsx)(f.Z,{onClick:u,children:"Will create Firestore User"}):(0,t.jsx)(W,{})}),[r,a,o,c,s,u]);return(0,t.jsx)(w,{header:(0,t.jsx)(y,{firebaseAuthUser:c}),children:(0,t.jsx)("div",{className:"min-h-[50rem] w-full lg:w-[64rem] lg:max-w-[64rem]",children:l})})}},4832:function(e,r,n){var t,i,a,o,u;n.d(r,{Wq:function(){return t},I1:function(){return u}}),function(e){e.email="email",e.password="password"}(t||(t={})),function(e){e.hidden="hidden",e.name="name",e.imageUrl="image-url"}(i||(i={})),function(e){e.itemName="item-name",e.cost="cost",e.userReference="user-reference"}(a||(a={})),function(e){e.name="name",e.file="file"}(o||(o={})),function(e){e.name="name",e.cost="cost",e.type="type",e.hidden="hidden"}(u||(u={}))},1547:function(e,r,n){var t=n(7294),i=n(5748),a=n(317);function o(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function u(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,i,a=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(t=n.next()).done)&&(a.push(t.value),!r||a.length!==r);o=!0);}catch(c){u=!0,i=c}finally{try{o||null==n.return||n.return()}finally{if(u)throw i}}return a}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return o(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r.Z=function(){var e=u(t.useState(!0),2),r=e[0],n=e[1],o=u(t.useState(null),2),c=o[0],s=o[1];return t.useEffect((function(){var e=(0,i.Aj)(a.lX,(function(e){s(e),n(!1)}));return function(){e()}}),[]),{isFirst:r,firebaseAuthUser:c}}},1165:function(e,r,n){n.d(r,{M1:function(){return t},g7:function(){return i}});var t=[{path:"/order",title:"Orders"},{path:"/restaurant",title:"Restaurants"}],i=["jason@fontech.com.tw","service@fontech.com.tw","livia@fontech.com.tw"]},1030:function(e,r,n){var t=n(7294);function i(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function a(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,i,a=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(t=n.next()).done)&&(a.push(t.value),!r||a.length!==r);o=!0);}catch(c){u=!0,i=c}finally{try{o||null==n.return||n.return()}finally{if(u)throw i}}return a}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return i(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r.Z=function(){var e=a(t.useState(!1),2),r=e[0],n=e[1],i=t.useCallback((function(e){r||(n(!0),e((function(){n(!1)})))}),[r]);return{isLoading:r,setIsLoading:n,isLoadingHandler:i}}},9726:function(e,r,n){n.d(r,{Z:function(){return c}});var t=n(7294),i=n(9903),a=n(380),o=n(1912),u=n(1165),c=function(){var e=(0,i.I0)(),r=(0,i.v9)((function(e){return{isInit:e.userManagerState.isInit,userDoc:e.userManagerState.userDoc}}),i.wU),n=r.isInit,c=r.userDoc,s=t.useMemo((function(){return(0,o.wA)(c)}),[c]),l=t.useMemo((function(){var e=null===s||void 0===s?void 0:s.email;return!!e&&u.g7.includes(e)}),[s]);return{doUpdateUser:function(r){e(function(e){return{type:a.f.UPDATE_USER,userDoc:e}}(r))},doRemoveUser:function(){e({type:a.f.REMOVE_USER})},doInitUserManager:function(){e({type:a.f.INIT})},isInit:n,userDoc:c,user:s,isCanWriteFireStoreEmailUser:l}}}}]);