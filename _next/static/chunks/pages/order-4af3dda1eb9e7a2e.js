(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[941],{1996:function(r,n,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/order",function(){return e(7988)}])},7988:function(r,n,e){"use strict";e.r(n),e.d(n,{default:function(){return A}});var t=e(4051),o=e.n(t),a=e(5893),c=e(7294),i=e(8580),u=e(7633),s=e(4193),l=e(963),f=e(1912);function d(r,n){(null==n||n>r.length)&&(n=r.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=r[e];return t}function h(r,n,e,t,o,a,c){try{var i=r[a](c),u=i.value}catch(s){return void e(s)}i.done?n(u):Promise.resolve(u).then(t,o)}function p(r){return function(){var n=this,e=arguments;return new Promise((function(t,o){var a=r.apply(n,e);function c(r){h(a,t,o,c,i,"next",r)}function i(r){h(a,t,o,c,i,"throw",r)}c(void 0)}))}}function v(r,n){return function(r){if(Array.isArray(r))return r}(r)||function(r,n){var e=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=e){var t,o,a=[],c=!0,i=!1;try{for(e=e.call(r);!(c=(t=e.next()).done)&&(a.push(t.value),!n||a.length!==n);c=!0);}catch(u){i=!0,o=u}finally{try{c||null==e.return||e.return()}finally{if(i)throw o}}return a}}(r,n)||function(r,n){if(!r)return;if("string"===typeof r)return d(r,n);var e=Object.prototype.toString.call(r).slice(8,-1);"Object"===e&&r.constructor&&(e=r.constructor.name);if("Map"===e||"Set"===e)return Array.from(e);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return d(r,n)}(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var m=function(r){var n=(0,s.Z)(),e=n.isLoading,t=n.error,a=n.setError,i=n.isLoadingHandler,d=v(c.useState(void 0),2),h=d[0],m=d[1],x=c.useMemo((function(){return(0,f.wA)(r)}),[r]),y=c.useMemo((function(){return(0,f.wA)(h)}),[h]),w=c.useCallback((function(r){(function(){var n=p(o().mark((function n(){var e,t,c;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(m(void 0),a(void 0),n.prev=2,x){n.next=5;break}throw new Error("order not found");case 5:if((e=x["restaurant-reference"]).path){n.next=8;break}throw new Error("restaurantReference path not found");case 8:return n.next=10,(0,u.Z)({path:e.path});case 10:t=n.sent,m(t),n.next=18;break;case 14:n.prev=14,n.t0=n.catch(2),o=n.t0,i=Error,c=(null!=i&&"undefined"!==typeof Symbol&&i[Symbol.hasInstance]?i[Symbol.hasInstance](o):o instanceof i)?n.t0:new Error("getRestaurantDoc Error"),a(c);case 18:r();case 19:case"end":return n.stop()}var o,i}),n,null,[[2,14]])})));return function(){return n.apply(this,arguments)}})()()}),[x,a]),b=c.useCallback((function(){i(w)}),[i,w]);c.useCallback((function(){(function(){var r=p(o().mark((function r(){var n,e;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,x){r.next=3;break}throw new Error("order not found");case 3:if((n=x["restaurant-reference"]).path){r.next=6;break}throw new Error("restaurantReference path not found");case 6:return r.next=8,(0,u.Z)({path:n.path});case 8:e=r.sent,m(e),r.next=14;break;case 12:r.prev=12,r.t0=r.catch(0);case 14:case"end":return r.stop()}}),r,null,[[0,12]])})));return function(){return r.apply(this,arguments)}})()()}),[x]);var j=(0,l.Z)(b).isInit,k=c.useMemo((function(){var r=null===y||void 0===y?void 0:y.name;return r||""}),[y]);return{isInit:j,isLoading:e,error:t,order:x,restaurant:y,restaurantDoc:h,restaurantName:k}},x=e(576),y=function(r){var n=r.orderDoc,e=m(n),t=e.isLoading,o=e.restaurantName,i=c.useMemo((function(){return t?"".concat(n.id," Loading..."):o?"".concat(n.id," ").concat(o):n.id}),[t,o,n.id]);return(0,a.jsx)("li",{children:(0,a.jsx)(x.Z,{title:i,linkProps:{href:"/order/[id]?id=".concat(n.id),as:"".concat("/FontechOrder","/order/[id]?id=").concat(n.id)}})})},w=function(r){var n=c.useMemo((function(){return(0,f.wA)(r)}),[r]),e=c.useMemo((function(){var r=null===n||void 0===n?void 0:n["restaurant-name"];return r||""}),[n]);return{order:n,restaurantName:e}},b=function(r){var n=r.orderDoc,e=w(n).restaurantName,t=c.useMemo((function(){return e?"".concat(n.id," ").concat(e):n.id}),[e,n.id]);return(0,a.jsx)("li",{children:(0,a.jsx)(x.Z,{title:t,linkProps:{href:"/order/history/[id]?id=".concat(n.id),as:"".concat("/FontechOrder","/order/history/[id]?id=").concat(n.id)}})})},j=e(3695),k=function(){var r=(0,j.Z)(),n=r.isInit,e=r.isLoading,t=r.finishedOrderDocs,o=r.unfinishedOrderDocs,c=r.historyOrderDocs;return n?(0,a.jsx)("div",{children:"isInit..."}):e?(0,a.jsx)("div",{children:"isLoading..."}):(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"Active:"}),(0,a.jsx)("ul",{className:"list-decimal pl-8",children:o.map((function(r,n){return(0,a.jsx)(y,{orderDoc:r},"orderDoc_".concat(n))}))}),(0,a.jsx)("p",{children:"Finish:"}),(0,a.jsx)("ol",{className:"list-disc pl-8",children:t.map((function(r,n){return(0,a.jsx)(y,{orderDoc:r},"orderDoc_".concat(n))}))}),(0,a.jsx)("p",{children:"History:"}),(0,a.jsx)("ol",{className:"list-disc pl-8",children:c.map((function(r,n){return(0,a.jsx)(b,{orderDoc:r},"orderDoc_".concat(n))}))})]})},g=e(9726),D=function(){return(0,g.Z)().isCanWriteFireStoreEmailUser?(0,a.jsx)(x.Z,{className:"flex justify-end",title:"\u65b0\u589e\u9ede\u83dc",linkProps:{href:"/order/create",as:"".concat("/FontechOrder","/order/create")}}):null};function E(r,n,e,t,o,a,c){try{var i=r[a](c),u=i.value}catch(s){return void e(s)}i.done?n(u):Promise.resolve(u).then(t,o)}function _(r){return function(){var n=this,e=arguments;return new Promise((function(t,o){var a=r.apply(n,e);function c(r){E(a,t,o,c,i,"next",r)}function i(r){E(a,t,o,c,i,"throw",r)}c(void 0)}))}}!function(){var r=_(o().mark((function r(){var n,e;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return console.log("tryDB"),r.prev=1,r.next=4,fetch("http://localhost:3000/api/db");case 4:return n=r.sent,r.next=7,n.json();case 7:e=r.sent,console.log("response jsonData: ",e),r.next=14;break;case 11:r.prev=11,r.t0=r.catch(1),console.log("tryDB error");case 14:case"end":return r.stop()}}),r,null,[[1,11]])})))}();var N=function(){var r=_(o().mark((function r(){var n,e;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fetch("http://localhost:3000/api/requestUsers");case 2:return n=r.sent,r.next=5,n.json();case 5:return e=r.sent,r.abrupt("return",e);case 7:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();function P(r,n,e,t,o,a,c){try{var i=r[a](c),u=i.value}catch(s){return void e(s)}i.done?n(u):Promise.resolve(u).then(t,o)}var A=function(){return c.useEffect((function(){(function(){var r,n=(r=o().mark((function r(){var n;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,N();case 3:n=r.sent,console.log("users: ",n),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),console.log("asyncRequestUsers fail.");case 10:case"end":return r.stop()}}),r,null,[[0,7]])})),function(){var n=this,e=arguments;return new Promise((function(t,o){var a=r.apply(n,e);function c(r){P(a,t,o,c,i,"next",r)}function i(r){P(a,t,o,c,i,"throw",r)}c(void 0)}))});return function(){return n.apply(this,arguments)}})()()}),[]),(0,a.jsxs)(i.Z,{children:[(0,a.jsx)(D,{}),(0,a.jsx)(k,{})]})}}},function(r){r.O(0,[890,580,695,774,888,179],(function(){return n=1996,r(r.s=n);var n}));var n=r.O();_N_E=n}]);