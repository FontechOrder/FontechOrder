(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[584],{8065:function(n,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/new-order",function(){return r(9618)}])},4607:function(n,e,r){"use strict";var t=r(5893),a=r(7294),i=r(6822),c=r(6242),o=r(4229),u=r(5811);e.Z=function(n){var e=n.children,r=(0,u.Z)(),s=r.isInit,l=r.adminUser,f=a.useMemo((function(){return s?(0,t.jsx)(i.Z,{children:"Init..."}):l?e:(0,t.jsx)(i.Z,{children:"404!"})}),[s,l,e]);return(0,t.jsx)(c.Z,{header:(0,t.jsx)(o.Z,{}),children:(0,t.jsx)(i.Z,{m:2,children:f})})}},9618:function(n,e,r){"use strict";r.r(e),r.d(e,{default:function(){return U}});var t=r(5893),a=r(7294),i=r(4607),c=r(4051),o=r.n(c),u=r(6822),s=r(6886),l=r(5113),f=r(1024),d=r(6447),h=r(3946),p=r(7918),m=r(3321),v=r(5759),x=r(4282),y=r(7798),w=r(7087),b=r(720),j=r(9714),Z=r(3075),k=r(722),g=r(1364),N=r(3019),P=r(3298);function S(n,e,r,t,a,i,c){try{var o=n[i](c),u=o.value}catch(s){return void r(s)}o.done?e(u):Promise.resolve(u).then(t,a)}var A=function(){var n,e=(n=o().mark((function n(e){var r,t,a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,P.O.from("orders").insert(e);case 2:if(r=n.sent,t=r.data,!(a=r.error)){n.next=7;break}throw a;case 7:if(t){n.next=9;break}throw new Error("invalid orders");case 9:return n.abrupt("return",t);case 10:case"end":return n.stop()}}),n)})),function(){var e=this,r=arguments;return new Promise((function(t,a){var i=n.apply(e,r);function c(n){S(i,t,a,c,o,"next",n)}function o(n){S(i,t,a,c,o,"throw",n)}c(void 0)}))});return function(n){return e.apply(this,arguments)}}(),E=r(1622);function O(n,e){(null==e||e>n.length)&&(e=n.length);for(var r=0,t=new Array(e);r<e;r++)t[r]=n[r];return t}function T(n,e,r,t,a,i,c){try{var o=n[i](c),u=o.value}catch(s){return void r(s)}o.done?e(u):Promise.resolve(u).then(t,a)}function _(n){return function(){var e=this,r=arguments;return new Promise((function(t,a){var i=n.apply(e,r);function c(n){T(i,t,a,c,o,"next",n)}function o(n){T(i,t,a,c,o,"throw",n)}c(void 0)}))}}function C(n,e,r){return e in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}function I(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})))),t.forEach((function(e){C(n,e,r[e])}))}return n}function M(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var r=null==n?null:"undefined"!==typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=r){var t,a,i=[],c=!0,o=!1;try{for(r=r.call(n);!(c=(t=r.next()).done)&&(i.push(t.value),!e||i.length!==e);c=!0);}catch(u){o=!0,a=u}finally{try{c||null==r.return||r.return()}finally{if(o)throw a}}return i}}(n,e)||R(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(n){return function(n){if(Array.isArray(n))return O(n)}(n)||function(n){if("undefined"!==typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||R(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(n,e){if(n){if("string"===typeof n)return O(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(n,e):void 0}}var H=function(){var n=M(a.useState(!1),2),e=n[0],r=n[1],i=M(a.useState(new Date),2),c=i[0],P=i[1],S=M(a.useState([]),2),O=S[0],T=S[1],C=M(a.useState([]),2),R=C[0],H=C[1],U=M(a.useState([]),2),W=U[0],L=U[1],X=M(a.useState([]),2),F=X[0],$=X[1],q=a.useCallback((function(){(function(){var n=_(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:(0,g.Z)().then((function(n){L(n)})).catch();case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}})()()}),[]),z=a.useCallback((function(){var n=(0,E.P1)({array:W,length:R.length});$(R.flatMap((function(e,r){var t=n[r];return t?[{dateText:e,restaurant:t}]:[]})))}),[W,R]),B=a.useCallback((function(){e||(r(!0),function(){var n=_(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,A(F.map((function(n){return{finish:!1,date_text:n.dateText,restaurant:n.restaurant.id}})));case 3:$([]),n.next=8;break;case 6:n.prev=6,n.t0=n.catch(0);case 8:r(!1);case 9:case"end":return n.stop()}}),n,null,[[0,6]])})));return function(){return n.apply(this,arguments)}}()())}),[e,F]);return a.useEffect((function(){q()}),[q]),a.useEffect((function(){(function(){var n=_(o().mark((function n(){var e;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,N.Z)();case 3:e=n.sent,T(e.map((function(n){return n.date_text}))),n.next=9;break;case 7:n.prev=7,n.t0=n.catch(0);case 9:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(){return n.apply(this,arguments)}})()()}),[]),(0,t.jsx)(u.Z,{children:(0,t.jsxs)(s.ZP,{container:!0,spacing:1,justifyContent:"space-around",columns:16,children:[(0,t.jsx)(s.ZP,{item:!0,xs:16,md:8,children:(0,t.jsx)(l.Z,{children:(0,t.jsx)(b._,{dateAdapter:w.Z,children:(0,t.jsx)(j.w,{displayStaticWrapperAs:"desktop",label:"Week picker",value:c,onChange:function(n){if(P(n),n){var e=(0,k.formatInTimeZone)(n,"Asia/Taipei","yyyy-MM-dd");H((function(n){return n.includes(e)?n.filter((function(n){return n!==e})):n.length>=7?n:D(n).concat([e])}))}},renderDay:function(n,e,r){if(!n)return(0,t.jsx)(Z.H,I({},r));var a=(0,k.formatInTimeZone)(n,"Asia/Taipei","yyyy-MM-dd");return O.includes(a)?(0,t.jsx)(Z.H,I({className:"!bg-gray-400 !text-white"},r,{disabled:!0})):R.includes(a)?(0,t.jsx)(Z.H,I({className:"!bg-yellow-400 !text-white"},r)):(0,t.jsx)(Z.H,I({},r))},renderInput:function(n){return(0,t.jsx)(y.Z,I({},n))},inputFormat:"'Week of' MMM d"})})})}),(0,t.jsx)(s.ZP,{item:!0,xs:16,md:7,children:(0,t.jsxs)(l.Z,{className:"p-2",children:[(0,t.jsxs)(f.Z,{className:"p-2",children:[(0,t.jsxs)(d.Z,{direction:"row",alignItems:"center",children:[(0,t.jsx)(u.Z,{className:"text-green-600",children:"Marked DateTextList (max:7):"}),(0,t.jsx)(h.Z,{onClick:function(){return H([])},children:(0,t.jsx)(x.Z,{})})]}),(0,t.jsx)(d.Z,{className:"flex-wrap",direction:"row",children:R.sort().map((function(n){return(0,t.jsx)(p.Z,{className:"!mr-1 !mt-1",label:n,variant:"outlined",onDelete:function(){return H((function(e){return e.filter((function(e){return e!==n}))}))}},"markedText-".concat(n))}))})]}),(0,t.jsxs)(f.Z,{className:"p-2",children:[(0,t.jsxs)(d.Z,{direction:"row",alignItems:"center",children:[(0,t.jsx)(u.Z,{className:"text-green-600",children:"RestaurantList from Random:"}),(0,t.jsx)(h.Z,{onClick:q,children:(0,t.jsx)(x.Z,{})})]}),(0,t.jsx)(d.Z,{className:"flex-wrap",direction:"row",children:W.map((function(n){return(0,t.jsx)(p.Z,{className:"!mr-1 !mt-1",label:n.name,variant:"outlined",onDelete:function(){return L((function(e){return e.filter((function(e){return e.id!==n.id}))}))}},"restaurant-".concat(n.id))}))})]}),(0,t.jsx)(m.Z,{disabled:0===R.length,className:"!mt-2",variant:"contained",onClick:z,children:"RANDOM RESTAURANT"})]})}),F&&(0,t.jsxs)(s.ZP,{item:!0,xs:16,children:[(0,t.jsx)(l.Z,{className:"p-2",children:F.map((function(n){return(0,t.jsx)(u.Z,{children:"".concat(n.dateText,": ").concat(n.restaurant.name)},"create-order-".concat(n.dateText))}))}),(0,t.jsx)(v.Z,{disabled:0===F.length,loading:e,className:"!mt-2",variant:"contained",onClick:B,children:"CREATE ORDER"})]})]})})},U=function(){return(0,t.jsx)(i.Z,{children:(0,t.jsx)(H,{})})}},3019:function(n,e,r){"use strict";var t=r(4051),a=r.n(t),i=r(3298);function c(n,e,r,t,a,i,c){try{var o=n[i](c),u=o.value}catch(s){return void r(s)}o.done?e(u):Promise.resolve(u).then(t,a)}var o=function(){var n,e=(n=a().mark((function n(){var e,r,t;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.O.from("orders").select();case 2:if(e=n.sent,r=e.data,!(t=e.error)){n.next=7;break}throw t;case 7:if(r){n.next=9;break}throw new Error("no order list");case 9:return n.abrupt("return",r);case 10:case"end":return n.stop()}}),n)})),function(){var e=this,r=arguments;return new Promise((function(t,a){var i=n.apply(e,r);function o(n){c(i,t,a,o,u,"next",n)}function u(n){c(i,t,a,o,u,"throw",n)}o(void 0)}))});return function(){return e.apply(this,arguments)}}();e.Z=o},1364:function(n,e,r){"use strict";var t=r(4051),a=r.n(t),i=r(3298);function c(n,e,r,t,a,i,c){try{var o=n[i](c),u=o.value}catch(s){return void r(s)}o.done?e(u):Promise.resolve(u).then(t,a)}var o=function(){var n,e=(n=a().mark((function n(){var e,r,t;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.O.from("restaurants").select();case 2:if(e=n.sent,r=e.data,!(t=e.error)){n.next=7;break}throw t;case 7:if(r){n.next=9;break}throw new Error("no restaurant list");case 9:return n.abrupt("return",r);case 10:case"end":return n.stop()}}),n)})),function(){var e=this,r=arguments;return new Promise((function(t,a){var i=n.apply(e,r);function o(n){c(i,t,a,o,u,"next",n)}function u(n){c(i,t,a,o,u,"throw",n)}o(void 0)}))});return function(){return e.apply(this,arguments)}}();e.Z=o}},function(n){n.O(0,[240,345,528,469,213,774,888,179],(function(){return e=8065,n(n.s=e);var e}));var e=n.O();_N_E=e}]);