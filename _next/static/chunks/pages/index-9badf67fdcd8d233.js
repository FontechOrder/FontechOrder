(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{45301:function(r,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(30441)}])},12648:function(r,t,n){"use strict";var e=n(85893),i=(n(67294),n(99103)),o=n(44229);t.Z=function(r){var t=r.children;return(0,e.jsx)(i.Z,{header:(0,e.jsx)(o.Z,{}),children:t})}},56207:function(r,t,n){"use strict";n.d(t,{Z:function(){return k}});var e=n(85893),i=n(67294),o=n(36822),a=n(96476),u=n(77773),c=n(56903),s=n(89664),d=n(52420),l=n(73019),f=n(41622),v=n(8430),h=function(r){return{type:v.Z.SET_IS_LOADING,isLoading:r}},b=function(){var r=(0,d.v9)((function(r){return r.orderListManagerState}),d.wU);return{isInit:r.isInit,isLoading:r.isLoading,orderList:r.orderList}},p=function(){var r=(0,d.I0)(),t=b(),n=t.isInit,e=t.isLoading,o=t.orderList,a=i.useCallback((function(t){return r(h(t))}),[r]),u=i.useCallback((function(t){return r((function(r){r(h(!1)),r(function(r){return{type:v.Z.SAVE_ORDER_LIST,orderList:r}}(t))}))}),[r]),c=i.useCallback((function(){r({type:v.Z.CLEAR})}),[r]),s=i.useCallback((function(r){if(e){null===r||void 0===r||r({pauseByLoading:!0})}else a(!0),(0,l.Z)().then((function(t){u(t);null===r||void 0===r||r({pauseByLoading:!1})})).catch((function(t){var n={pauseByLoading:!1,error:(0,f.OZ)(t)};null===r||void 0===r||r(n),a(!1)}))}),[e,a,u]);return{isInit:n,isLoading:e,doFetchOrderListWithCallback:s,doSetIsLoading:a,doSaveOrderList:u,doClearOrderList:c,orderList:o}};function L(r,t){(null==t||t>r.length)&&(t=r.length);for(var n=0,e=new Array(t);n<t;n++)e[n]=r[n];return e}function y(r){return function(r){if(Array.isArray(r))return L(r)}(r)||function(r){if("undefined"!==typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function(r,t){if(!r)return;if("string"===typeof r)return L(r,t);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(r,t)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var m=function(){var r=p(),t=r.isInit,n=r.isLoading,e=r.doFetchOrderListWithCallback,o=r.doSaveOrderList,a=r.doClearOrderList,u=r.orderList,c=i.useCallback((function(r){if(!r.errors){var t=r.new;t&&o(y(u).concat([t]))}}),[o,u]),d=i.useCallback((function(r){var t;if(!r.errors){var n=null===(t=r.old)||void 0===t?void 0:t.id;if(n&&!(n<=0)){var e=r.new;if(e){var i=u.map((function(r){return r.id===n?e:r}));o(i)}}}}),[o,u]),l=i.useCallback((function(r){var t;if(!r.errors){var n=null===(t=r.old)||void 0===t?void 0:t.id;n&&(n<=0||o(u.filter((function(r){return r.id!==n}))))}}),[o,u]);return(0,s.Z)({path:"orders",insertCallback:c,updateCallback:d,deleteCallback:l}),i.useEffect((function(){t&&e()}),[t,e]),{isInit:t,isLoading:n,doFetchOrderListWithCallback:e,doClearOrderList:a,orderList:u}},C=n(20160),k=function(){var r=m(),t=r.isInit,n=r.isLoading,s=r.doFetchOrderListWithCallback,d=r.orderList,l=(0,C.Z)().doAddToAlertList,f=i.useMemo((function(){return n?[]:d.map((function(r){return{title:r.date_text,start:r.date_text+"T00:00:00+08:00",backgroundColor:r.finish?"red":"",borderColor:r.finish?"red":"",extendedProps:{order:r},url:r.finish?"":"".concat("/FontechOrder","/orders/detail?id=").concat(r.id)}}))}),[n,d]),v=i.useMemo((function(){return{text:n?"Loading":"D.C.",click:function(){return s((function(r){var t=r.pauseByLoading,n=r.error;t||n&&l({severity:"error",alertTitle:"fetch orderList error: "+n.message})}))}}}),[n,s,l]);return t?(0,e.jsx)(o.Z,{m:2,children:" isInit "}):(0,e.jsx)(o.Z,{m:2,children:(0,e.jsx)(a.ZPm,{locale:"zh-tw",defaultAllDay:!0,allDayText:"menu",contentHeight:"auto",customButtons:{reloadButton:v},plugins:[u.ZP,c.Z],initialView:"dayGridMonth",headerToolbar:{left:"prev,next today reloadButton",center:"title",right:"dayGridMonth,listMonth"},views:{dayGridMonth:{buttonText:"\u6708"},listMonth:{buttonText:"\u5217\u8868"}},events:f})})}},30441:function(r,t,n){"use strict";n.r(t);var e=n(85893),i=(n(67294),n(12648)),o=n(56207);t.default=function(){return(0,e.jsx)(i.Z,{children:(0,e.jsx)(o.Z,{})})}},73019:function(r,t,n){"use strict";var e=n(34051),i=n.n(e),o=n(53298);function a(r,t,n,e,i,o,a){try{var u=r[o](a),c=u.value}catch(s){return void n(s)}u.done?t(c):Promise.resolve(c).then(e,i)}var u=function(){var r,t=(r=i().mark((function r(){var t,n,e;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o.O.from("orders").select();case 2:if(t=r.sent,n=t.data,!(e=t.error)){r.next=7;break}throw e;case 7:if(n){r.next=9;break}throw new Error("no order list");case 9:return r.abrupt("return",n);case 10:case"end":return r.stop()}}),r)})),function(){var t=this,n=arguments;return new Promise((function(e,i){var o=r.apply(t,n);function u(r){a(o,e,i,u,c,"next",r)}function c(r){a(o,e,i,u,c,"throw",r)}u(void 0)}))});return function(){return t.apply(this,arguments)}}();t.Z=u},89664:function(r,t,n){"use strict";var e=n(67294),i=n(53298),o=n(41622);t.Z=function(r){var t=r.path,n=r.insertCallback,a=void 0===n?o.G1:n,u=r.updateCallback,c=void 0===u?o.G1:u,s=r.deleteCallback,d=void 0===s?o.G1:s;return e.useEffect((function(){var r=i.O.from(t).on("INSERT",a).on("UPDATE",c).on("DELETE",d).subscribe();return function(){i.O.removeSubscription(r)}}),[t,a,c,d]),{}}}},function(r){r.O(0,[870,643,954,808,404,774,888,179],(function(){return t=45301,r(r.s=t);var t}));var t=r.O();_N_E=t}]);