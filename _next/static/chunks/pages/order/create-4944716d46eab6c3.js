(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[944],{659:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/order/create",function(){return n(6863)}])},6863:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return _}});var r=n(5893),a=n(7294),o=n(2265),i=n(4051),u=n.n(i),s=n(9198),c=n.n(s),l=n(2298),d=n(9474),f=n(7349),m=n(1393),h=n(5673),p=n(1242),y=n(8973),v=n(8231),x=n(1912),b=n(3695);function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function S(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var g=function(){var e=(0,v.Z)({path:"restaurants",orderByKey:"name"}),t=e.isInit,n=e.isLoading,r=e.docDatas,o=(0,b.Z)(),i=o.isInit,u=o.isLoading,s=o.finishedOrderDocs,c=o.unfinishedOrderDocs,l=a.useMemo((function(){return(0,x.e)((0,x.UO)(S(s).concat(S(c))).reduce((function(e,t){var n=t.data["date-text"];return n?S(e).concat([n]):e}),Array()))}),[s,c]);return{isInit:a.useMemo((function(){return t||i}),[t,i]),isLoading:a.useMemo((function(){return n||u}),[n,u]),restaurantIsInit:t,restaurantIsLoading:n,orderIsInit:i,orderIsLoading:u,restaurantDocDatas:r,existDateTexts:l}},j=n(4184),w=n.n(j),I=function(e){var t=e.selectedDeleteRestaurants,n=e.selectedRestaurantOnClick;return(0,r.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,r.jsx)("div",{children:"restaurants: "}),t.map((function(e,t){return(0,r.jsx)("div",{className:"flex flex-row pl-2",children:(0,r.jsx)("button",{className:w()("pr-2",e.delete&&"line-through"),onClick:function(){return n(e)},children:(0,r.jsxs)("p",{className:w()(e.delete&&"line-through",e.delete&&"text-gray-400"),children:[t+1,"."," ",e.documentDataSnapshot.id]})})},"restaurant-".concat(e.documentDataSnapshot.id))}))]})};function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function N(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,a)}function A(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){N(o,r,a,i,u,"next",e)}function u(e){N(o,r,a,i,u,"throw",e)}i(void 0)}))}}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(s){u=!0,a=s}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(e,t)||E(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||E(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){if(e){if("string"===typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}var Z=function(){var e=g(),t=e.isInit,n=e.isLoading,o=e.restaurantDocDatas,i=e.existDateTexts,s=C(a.useState([]),2),v=s[0],b=s[1],D=C(a.useState([]),2),S=D[0],j=D[1],w=C(a.useState(!1),2),k=w[0],N=w[1],E=C(a.useState([]),2),Z=E[0],O=E[1],_=C(a.useState(!1),2),T=_[0],P=_[1],L=a.useCallback((function(e){b(M(M(v.filter((function(t){return t.documentDataSnapshot.id!==e.documentDataSnapshot.id}))).concat([{documentDataSnapshot:e.documentDataSnapshot,delete:!e.delete}])).sort((function(e){return e.delete?1:-1})))}),[v]),R=a.useMemo((function(){return console.log("exclude dates existDateTexts: ",i),M(Z)}),[Z,i]),U=a.useMemo((function(){return 0===Z.length}),[Z]),X=a.useMemo((function(){var e=0===S.length;return k||e}),[k,S]),F=a.useMemo((function(){return Z.length>=7}),[Z]);a.useEffect((function(){b(o.map((function(e){return{documentDataSnapshot:e.doc,delete:!1}})))}),[o]);var $=a.useCallback((function(){var e=(0,x.TV)(v.filter((function(e){return!e.delete}))).slice(0,Z.length);j(Z.map((function(t,n){var r;return{date:t,restaurantDocumentDataSnapshot:null===(r=e[n])||void 0===r?void 0:r.documentDataSnapshot}})))}),[Z,v]),B=a.useCallback((function(){(function(){var e=A(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(!0),e.prev=1,e.next=4,Promise.all(S.map(function(){var e=A(u().mark((function e(t){var n,r,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.restaurantDocumentDataSnapshot){e.next=2;break}return e.abrupt("return");case 2:if(n=(0,m.Z)({locale:h.Z},"yyyy-MM-dd"),r=n(t.date)){e.next=6;break}throw new Error("dateText not found");case 6:return a={finished:!1,"date-text":r,"restaurant-reference":t.restaurantDocumentDataSnapshot.ref},console.log("datePairRestaurant document: ",a),e.next=10,(0,y.Z)({path:"orders/"+r,data:a});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:j([]),window.alert("success"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),t=e.t0,(null!=(n=Error)&&"undefined"!==typeof Symbol&&n[Symbol.hasInstance]?n[Symbol.hasInstance](t):t instanceof n)?console.log("datePairRestaurant error: ",e.t0.message):console.log("datePairRestaurant error"),window.alert("some error");case 12:N(!1);case 13:case"end":return e.stop()}var t,n}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}})()()}),[S]),K=a.useMemo((function(){return S.map((function(e,t){var n;return(0,r.jsxs)("div",{className:"flex flex-row",children:[(0,r.jsx)("div",{className:"pr-2",children:(0,l.default)(e.date,"yyyy/MM/dd")}),(0,r.jsx)("div",{children:(null===(n=e.restaurantDocumentDataSnapshot)||void 0===n?void 0:n.id)||""})]},"random-date-pair-restaurant-".concat(t))}))}),[S]);return t||n?(0,r.jsx)("div",{children:"Order Create is loading..."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"mb-2 flex flex-row justify-around",children:[(0,r.jsx)(I,{selectedDeleteRestaurants:v,selectedRestaurantOnClick:L}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-start",children:[!U&&(0,r.jsx)("h2",{children:"selected dates:"}),(0,r.jsx)("div",{children:Z.sort(d.Z).map((function(e,t){var n=(0,m.Z)({locale:h.Z},"yyyy/MM/dd EEE")(e);return(0,r.jsxs)("div",{className:"flex flex-row",children:[(0,r.jsxs)("p",{children:[t+1,". ",n]}),(0,r.jsx)("button",{className:"pl-8",onClick:function(){return O((function(t){return t.filter((function(t){return e!==t}))}))},children:"X"})]},"dateText-".concat(n))}))}),(0,r.jsx)(p.Z,{className:"mr-2",disabled:F,onClick:function(e){e.preventDefault(),P(!T)},children:"add Date"}),T&&(0,r.jsx)(c(),{selected:null,excludeDates:R,onChange:function(e){P(!T),e&&O((function(t){return M(t).concat([e])}))},inline:!0,minDate:new Date,maxDate:(0,f.default)(new Date,14),popperPlacement:"top-start"})]})]}),(0,r.jsx)(p.Z,{className:"mr-2",disabled:U,onClick:$,children:"random restaurnats"}),(0,r.jsx)(p.Z,{className:"mr-2",disabled:X,onClick:B,children:k?"isLoading":"create order"}),K]})},O=n(9726),_=function(){var e=(0,O.Z)().isCanWriteFireStoreEmailUser;return(0,r.jsx)(o.Z,{children:e?(0,r.jsx)(Z,{}):(0,r.jsx)("div",{children:"???"})})}}},function(e){e.O(0,[890,989,265,695,774,888,179],(function(){return t=659,e(e.s=t);var t}));var t=e.O();_N_E=t}]);