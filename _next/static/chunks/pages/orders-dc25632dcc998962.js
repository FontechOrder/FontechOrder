(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[660],{8352:function(r,t,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/orders",function(){return e(8441)}])},2648:function(r,t,e){"use strict";var n=e(5893),o=(e(7294),e(6242)),i=e(4229);t.Z=function(r){var t=r.children;return(0,n.jsx)(o.Z,{header:(0,n.jsx)(i.Z,{}),children:t})}},6207:function(r,t,e){"use strict";e.d(t,{Z:function(){return S}});var n=e(5893),o=e(7294),i=e(6822),a=e(6476),u=e(7773),c=e(6903),l=e(9664),s=e(4051),d=e.n(s),f=e(2420),v=e(3019),h=e(1622),p=e(8430),b=function(r){return{type:p.Z.SAVE_ORDER_LIST,orderList:r}},y=function(){return{orderList:(0,f.v9)((function(r){return{orderList:r.orderListManagerState.orderList}}),f.wU).orderList}};function m(r,t,e,n,o,i,a){try{var u=r[i](a),c=u.value}catch(l){return void e(l)}u.done?t(c):Promise.resolve(c).then(n,o)}var C=function(){var r=(0,f.I0)(),t=y().orderList;return{doFetchOrderListWithCallback:o.useCallback((function(t){(function(){var e,n=(e=d().mark((function e(){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,v.Z)();case 3:n=e.sent,r(b(n)),null===t||void 0===t||t(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),null===t||void 0===t||t((0,h.iJ)(e.t0)||h.S2);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})),function(){var r=this,t=arguments;return new Promise((function(n,o){var i=e.apply(r,t);function a(r){m(i,n,o,a,u,"next",r)}function u(r){m(i,n,o,a,u,"throw",r)}a(void 0)}))});return function(){return n.apply(this,arguments)}})()()}),[r]),doSaveOrderList:o.useCallback((function(t){r(b(t))}),[r]),doClearOrderList:o.useCallback((function(){r({type:p.Z.CLEAR_ORDER_LIST})}),[r]),orderList:t}};function k(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function w(r){return function(r){if(Array.isArray(r))return k(r)}(r)||function(r){if("undefined"!==typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function(r,t){if(!r)return;if("string"===typeof r)return k(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);"Object"===e&&r.constructor&&(e=r.constructor.name);if("Map"===e||"Set"===e)return Array.from(e);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return k(r,t)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var L=function(){var r=C(),t=r.doFetchOrderListWithCallback,e=r.doSaveOrderList,n=r.doClearOrderList,i=r.orderList,a=o.useCallback((function(r){if(!r.errors){var t=r.new;t&&e(w(i).concat([t]))}}),[e,i]),u=o.useCallback((function(r){var t;if(!r.errors){var n=null===(t=r.old)||void 0===t?void 0:t.id;if(n&&!(n<=0)){var o=r.new;if(o){var a=i.map((function(r){return r.id===n?o:r}));e(a)}}}}),[e,i]),c=o.useCallback((function(r){var t;if(!r.errors){var n=null===(t=r.old)||void 0===t?void 0:t.id;n&&(n<=0||e(i.filter((function(r){return r.id!==n}))))}}),[e,i]);return(0,l.Z)({path:"orders",insertCallback:a,updateCallback:u,deleteCallback:c}),{doFetchOrderListWithCallback:t,doClearOrderList:n,orderList:i}};function O(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function x(r,t){return function(r){if(Array.isArray(r))return r}(r)||function(r,t){var e=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=e){var n,o,i=[],a=!0,u=!1;try{for(e=e.call(r);!(a=(n=e.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(c){u=!0,o=c}finally{try{a||null==e.return||e.return()}finally{if(u)throw o}}return i}}(r,t)||function(r,t){if(!r)return;if("string"===typeof r)return O(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);"Object"===e&&r.constructor&&(e=r.constructor.name);if("Map"===e||"Set"===e)return Array.from(e);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return O(r,t)}(r,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var S=function(){var r=x(o.useState(!0),2),t=r[0],e=r[1],l=x(o.useState(!1),2),s=l[0],d=l[1],f=L(),v=f.doClearOrderList,h=f.doFetchOrderListWithCallback,p=f.orderList,b=o.useMemo((function(){return p.map((function(r){return{title:r.date_text,start:r.date_text+"T00:00:00+08:00",backgroundColor:r.finish?"red":"",borderColor:r.finish?"red":"",extendedProps:{order:r},url:r.finish?"":"".concat("/FontechOrder","/orders/detail?id=").concat(r.id)}}))}),[p]),y=o.useCallback((function(){s||(d(!0),h((function(r){r&&console.log("doFetchOrderListWithCallback err:",r.message),console.log("doFetchOrderListWithCallback"),d(!1)})))}),[s,h]),m=o.useMemo((function(){return{text:s?"Loading":"D.C.",click:y}}),[s,y]);return o.useEffect((function(){t&&(e(!1),v(),y())}),[t,y,v]),(0,n.jsx)(i.Z,{m:2,children:(0,n.jsx)(a.ZPm,{locale:"zh-tw",defaultAllDay:!0,allDayText:"menu",contentHeight:"auto",customButtons:{reloadButton:m},plugins:[u.ZP,c.Z],initialView:"dayGridMonth",headerToolbar:{left:"prev,next today reloadButton",center:"title",right:"dayGridMonth,listMonth"},views:{dayGridMonth:{},listMonth:{buttonText:"list month"}},events:b})})}},8441:function(r,t,e){"use strict";e.r(t);var n=e(5893),o=(e(7294),e(2648)),i=e(6207);t.default=function(){return(0,n.jsx)(o.Z,{children:(0,n.jsx)(i.Z,{})})}},3019:function(r,t,e){"use strict";var n=e(4051),o=e.n(n),i=e(3298);function a(r,t,e,n,o,i,a){try{var u=r[i](a),c=u.value}catch(l){return void e(l)}u.done?t(c):Promise.resolve(c).then(n,o)}var u=function(){var r,t=(r=o().mark((function r(){var t,e,n;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,i.O.from("orders").select();case 2:if(t=r.sent,e=t.data,!(n=t.error)){r.next=7;break}throw n;case 7:if(e){r.next=9;break}throw new Error("no order list");case 9:return r.abrupt("return",e);case 10:case"end":return r.stop()}}),r)})),function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function u(r){a(i,n,o,u,c,"next",r)}function c(r){a(i,n,o,u,c,"throw",r)}u(void 0)}))});return function(){return t.apply(this,arguments)}}();t.Z=u},9664:function(r,t,e){"use strict";var n=e(7294),o=e(3298),i=e(1622);t.Z=function(r){var t=r.path,e=r.insertCallback,a=void 0===e?i.G1:e,u=r.updateCallback,c=void 0===u?i.G1:u,l=r.deleteCallback,s=void 0===l?i.G1:l;return n.useEffect((function(){var r=o.O.from(t).on("INSERT",a).on("UPDATE",c).on("DELETE",s).subscribe();return function(){o.O.removeSubscription(r)}}),[t,a,c,s]),{}}}},function(r){r.O(0,[870,240,426,808,213,774,888,179],(function(){return t=8352,r(r.s=t);var t}));var t=r.O();_N_E=t}]);