(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[188],{2388:function(r,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/new-menu",function(){return n(4945)}])},1077:function(r,e,n){"use strict";var t=n(5893),a=(n(7294),n(5675)),o=n(1714);function i(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function u(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})))),t.forEach((function(e){i(r,e,n[e])}))}return r}function c(r,e){if(null==r)return{};var n,t,a=function(r,e){if(null==r)return{};var n,t,a={},o=Object.keys(r);for(t=0;t<o.length;t++)n=o[t],e.indexOf(n)>=0||(a[n]=r[n]);return a}(r,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(t=0;t<o.length;t++)n=o[t],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(r,n)&&(a[n]=r[n])}return a}e.Z=function(r){var e=r.alt,n=void 0===e?"zoom-image":e,i=c(r,["alt"]);return(0,t.jsx)(o.Z,{wrapStyle:{width:"100%",height:"100%"},children:(0,t.jsx)("div",{className:"relative h-full w-full",children:(0,t.jsx)(a.default,u({},i,{alt:n}))})})}},301:function(r,e,n){"use strict";var t=n(7294),a=n(3869);function o(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function i(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,e){var n=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=n){var t,a,o=[],i=!0,u=!1;try{for(n=n.call(r);!(i=(t=n.next()).done)&&(o.push(t.value),!e||o.length!==e);i=!0);}catch(c){u=!0,a=c}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(r,e)||function(r,e){if(!r)return;if("string"===typeof r)return o(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(r,e)}(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}e.Z=function(r){var e=r.asyncCallback,n=r.customErrorCallback,o=i(t.useState(!0),2),u=o[0],c=o[1],l=t.useCallback((function(){return e}),[e]),s=(0,a.Z)({asyncCallback:l(),customErrorCallback:n}),f=s.isLoading,m=s.error,d=s.result,p=s.recall,v=s.fetchData,h=t.useCallback((function(){console.log("fetchData"),v({finishCallBack:function(){c(!1)}})}),[v]),y=t.useCallback((function(){return console.log("useInitLoadingResultError recall ".concat(u)),!u&&p()}),[u,p]);return t.useEffect((function(){u&&(f||h())}),[u,f,h]),t.useEffect((function(){u||h()}),[u,h]),{isInit:u,setIsInit:c,isLoading:f,error:m,result:d,recall:y}}},4945:function(r,e,n){"use strict";n.r(e),n.d(e,{default:function(){return ie}});var t=n(5893),a=n(7294),o=n(6822),i=n(6242),u=n(3994),c=n(9726),l=["jason@fontech.com.tw","service@fontech.com.tw"],s=["id","name","cost","type"],f=[{key:"name",required:!0,label:"Name"},{key:"cost",required:!0,type:"number",label:"Cost"},{key:"type",required:!1,label:"Type"}],m=[{key:"name",required:!0,label:"Name"},{key:"cost",required:!0,type:"number",label:"Cost"}];function d(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function p(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,e){var n=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=n){var t,a,o=[],i=!0,u=!1;try{for(n=n.call(r);!(i=(t=n.next()).done)&&(o.push(t.value),!e||o.length!==e);i=!0);}catch(c){u=!0,a=c}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(r,e)||function(r,e){if(!r)return;if("string"===typeof r)return d(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(r,e)}(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var v=function(){var r=p(a.useState(!0),2),e=r[0],n=r[1],t=(0,c.p)().user,o=a.useMemo((function(){if(t&&t.email&&l.includes(t.email))return t}),[t]);return a.useEffect((function(){e&&n(!1)}),[e]),{isInit:e,adminUser:o}},h=function(r){var e=r.children,n=v(),c=n.isInit,l=n.adminUser,s=a.useMemo((function(){return c?(0,t.jsx)(o.Z,{children:"Init..."}):l?e:(0,t.jsx)(o.Z,{children:"404!"})}),[c,l,e]);return(0,t.jsx)(i.Z,{header:(0,t.jsx)(u.Z,{}),children:(0,t.jsx)(o.Z,{m:2,children:s})})},y=n(6886),b=n(7798),x=n(5545),g=n(7970),w=n(4051),j=n.n(w),k=n(4184),S=n.n(k),Z=n(4231),O=n(7536),I=n(5496),A=n(3946),C=n(5113),P=n(5071),E=n(6815),N=n(5759),M=n(594),_=n(3321),L=n(473),T=n(7036),R=n(6540),U=n(1676),q=n(3298);function D(r,e,n,t,a,o,i){try{var u=r[o](i),c=u.value}catch(l){return void n(l)}u.done?e(c):Promise.resolve(c).then(t,a)}var $=function(){var r,e=(r=j().mark((function r(e){var n,t,a,o,i,u,c;return j().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}throw new Error("no input");case 2:if(n=e.name){r.next=5;break}throw new Error("no fileName");case 5:return r.next=7,q.O.storage.from("menus").upload("restaurant/"+n,e);case 7:if(t=r.sent,a=t.data,!(o=t.error)){r.next=12;break}throw o;case 12:if(a){r.next=14;break}throw new Error("update fail");case 14:return r.next=16,q.O.storage.from("menus").getPublicUrl("restaurant/"+n);case 16:if(i=r.sent,u=i.data,!(c=i.error)){r.next=21;break}throw c;case 21:if(u){r.next=23;break}throw new Error("update fail");case 23:return r.abrupt("return",u.publicURL);case 24:case"end":return r.stop()}}),r)})),function(){var e=this,n=arguments;return new Promise((function(t,a){var o=r.apply(e,n);function i(r){D(o,t,a,i,u,"next",r)}function u(r){D(o,t,a,i,u,"throw",r)}i(void 0)}))});return function(r){return e.apply(this,arguments)}}(),B=n(1077);function F(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function X(r,e,n,t,a,o,i){try{var u=r[o](i),c=u.value}catch(l){return void n(l)}u.done?e(c):Promise.resolve(c).then(t,a)}function z(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,e){var n=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=n){var t,a,o=[],i=!0,u=!1;try{for(n=n.call(r);!(i=(t=n.next()).done)&&(o.push(t.value),!e||o.length!==e);i=!0);}catch(c){u=!0,a=c}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(r,e)||function(r,e){if(!r)return;if("string"===typeof r)return F(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(r,e)}(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var G=function(r){var e=r.imageUrlCallback,n=z(a.useState(!1),2),i=n[0],u=n[1],c=z(a.useState(!1),2),l=c[0],s=c[1],f=(0,U.Z)(),m=f.recall,d=f.storageMenus,p=function(){return s(!1)},v=a.useCallback((function(r){(function(){var n,t=(n=j().mark((function n(){var t,a;return j().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!i){n.next=2;break}return n.abrupt("return");case 2:return u(!0),n.prev=3,n.next=7,$(null===(t=r.target.files)||void 0===t?void 0:t[0]);case 7:a=n.sent,p(),e(a),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(3),p();case 15:u(!1);case 16:case"end":return n.stop()}}),n,null,[[3,12]])})),function(){var r=this,e=arguments;return new Promise((function(t,a){var o=n.apply(r,e);function i(r){X(o,t,a,i,u,"next",r)}function u(r){X(o,t,a,i,u,"throw",r)}i(void 0)}))});return function(){return t.apply(this,arguments)}})()()}),[i,e]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(_.Z,{variant:"outlined",onClick:function(){m(),s(!0)},children:"SELECT RESTARUANT IMAGE"}),(0,t.jsx)(L.Z,{open:l,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,t.jsxs)(o.Z,{className:"absolute top-1/2 left-1/2 h-[90%] w-[90%] -translate-y-1/2 -translate-x-1/2 overflow-y-auto rounded bg-white p-4 shadow-xl lg:h-[40rem] lg:max-h-[90%] lg:w-[60rem]",children:[(0,t.jsx)(A.Z,{className:"float-right",color:"primary","aria-label":"close modal",component:"span",onClick:p,children:(0,t.jsx)(M.Z,{})}),(0,t.jsxs)(y.ZP,{container:!0,spacing:1,children:[(0,t.jsx)(y.ZP,{item:!0,xs:6,sm:4,md:3,children:(0,t.jsxs)("label",{htmlFor:"contained-button-file",children:[(0,t.jsx)("input",{className:"hidden",accept:"image/jpeg, image/png, image/jpg",id:"contained-button-file",type:"file",onChange:v}),(0,t.jsx)(N.Z,{loading:i,className:"aspect-[3/4] w-full",variant:"outlined",component:"span",children:(0,t.jsx)(R.Z,{})})]})}),d.map((function(r){return(0,t.jsx)(y.ZP,{item:!0,xs:6,sm:4,md:3,children:(0,t.jsxs)(o.Z,{className:"w-full",children:[(0,t.jsx)(_.Z,{startIcon:(0,t.jsx)(T.Z,{}),onClick:function(){p(),e(r.publicURL)},children:"\u9078\u6211\uff01"}),(0,t.jsx)(o.Z,{className:"relative aspect-[3/4] w-full",children:(0,t.jsx)(B.Z,{priority:!0,src:r.publicURL,alt:r.name,layout:"fill"})})]})},"storage-menu-".concat(r.name))}))]})]})})]})};function V(r,e,n,t,a,o,i){try{var u=r[o](i),c=u.value}catch(l){return void n(l)}u.done?e(c):Promise.resolve(c).then(t,a)}var W=function(){var r,e=(r=j().mark((function r(e){var n,t,a;return j().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,q.O.from("restaurants").insert(e);case 2:if(n=r.sent,t=n.data,!(a=n.error)){r.next=7;break}throw a;case 7:if(t){r.next=9;break}throw new Error("invalid restaurants");case 9:return r.abrupt("return",t);case 10:case"end":return r.stop()}}),r)})),function(){var e=this,n=arguments;return new Promise((function(t,a){var o=r.apply(e,n);function i(r){V(o,t,a,i,u,"next",r)}function u(r){V(o,t,a,i,u,"throw",r)}i(void 0)}))});return function(r){return e.apply(this,arguments)}}();function H(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function J(r,e,n,t,a,o,i){try{var u=r[o](i),c=u.value}catch(l){return void n(l)}u.done?e(c):Promise.resolve(c).then(t,a)}function K(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Q(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})))),t.forEach((function(e){K(r,e,n[e])}))}return r}function Y(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,e){var n=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=n){var t,a,o=[],i=!0,u=!1;try{for(n=n.call(r);!(i=(t=n.next()).done)&&(o.push(t.value),!e||o.length!==e);i=!0);}catch(c){u=!0,a=c}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(r,e)||function(r,e){if(!r)return;if("string"===typeof r)return H(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(r,e)}(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var rr=Z.Ry().shape({hidden:Z.Xg().transform((function(r){return!!r})),name:Z.Z_().required("\u9700\u8981\u9910\u5ef3\u540d").min(2,"\u592a\u5c112~"),image_url:Z.Z_().required("\u9700\u8981\u9910\u5ef3\u5716\u7247")}),er=function(){var r,e,n,i,u=Y(a.useState(!1),2),c=u[0],l=u[1],s=(0,O.cI)({resolver:(0,I.X)(rr)}),f=s.reset,m=s.register,d=s.setValue,p=s.watch,v=s.handleSubmit,h=s.formState.errors,x=Y(p(["image_url"]),1)[0],g=a.useCallback((function(r){return d("image_url",r,{shouldValidate:!0})}),[d]),w=a.useMemo((function(){return x?(0,t.jsxs)(o.Z,{className:S()("relative m-auto mt-3 aspect-[3/4] w-[30%]"),children:[(0,t.jsx)(B.Z,{priority:!0,src:x,alt:"select-image-url",layout:"fill"}),(0,t.jsx)(A.Z,{className:"!absolute !top-0 !right-0 !translate-x-1/2 !-translate-y-1/2",onClick:function(){return d("image_url","")},children:(0,t.jsx)(M.Z,{})})]}):(0,t.jsx)(G,{imageUrlCallback:g})}),[x,d,g]);return(0,t.jsx)(C.Z,{className:"p-2",children:(0,t.jsxs)(y.ZP,{container:!0,spacing:1,children:[(0,t.jsxs)(y.ZP,{className:"!my-auto flex flex-row",item:!0,xs:6,sm:5,md:5,children:[(0,t.jsx)(P.Z,Q({size:"small",required:!0,id:"hidden"},m("hidden"))),(0,t.jsx)(b.Z,Q({required:!0,id:"name",fullWidth:!0,variant:"standard"},m("name"),{error:!!h.name,helperText:null!==(n=null===(r=h.name)||void 0===r?void 0:r.message)&&void 0!==n?n:" "}))]}),(0,t.jsxs)(y.ZP,{className:"!my-auto flex flex-row",item:!0,xs:6,sm:5,md:5,children:[w,(0,t.jsx)(E.Z,{error:!0,children:null!==(i=null===(e=h.image_url)||void 0===e?void 0:e.message)&&void 0!==i?i:" "})]}),(0,t.jsx)(y.ZP,{className:"!my-auto",item:!0,xs:12,sm:2,md:2,children:(0,t.jsx)(N.Z,{loading:c,className:"xs:w-auto w-full",variant:"contained",onClick:v((function(r){(function(){var e,n=(e=j().mark((function e(){return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c){e.next=2;break}return e.abrupt("return");case 2:return l(!0),e.prev=3,e.next=6,W([r]);case 6:if(e.sent[0]){e.next=10;break}throw new Error("Invalid Restaurant");case 10:f({hidden:!1,name:"",image_url:""}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),console.log("asyncCreateRestaurants error");case 16:l(!1);case 17:case"end":return e.stop()}}),e,null,[[3,13]])})),function(){var r=this,n=arguments;return new Promise((function(t,a){var o=e.apply(r,n);function i(r){J(o,t,a,i,u,"next",r)}function u(r){J(o,t,a,i,u,"throw",r)}i(void 0)}))});return function(){return n.apply(this,arguments)}})()()})),children:"CREATE"})})]})})},nr=n(2882),tr=n(7906),ar=n(3184),or=n(8509),ir=n(3252),ur=n(295),cr=n(9305),lr=n(1622);function sr(r,e,n,t,a,o,i){try{var u=r[o](i),c=u.value}catch(l){return void n(l)}u.done?e(c):Promise.resolve(c).then(t,a)}var fr=function(){var r,e=(r=j().mark((function r(e){var n,t,a,o,i,u,c,l;return j().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.restaurantMenuList,t=e.restaurantId,r.next=3,q.O.from("menu_items").insert(n.menuItems.map((function(r){return{hidden:r.hidden,name:r.name,type:r.type,cost:r.cost,restaurant:t}})));case 3:if(a=r.sent,o=a.data,!a.error){r.next=8;break}throw new Error("insert menu_items error");case 8:if(i=null!==o&&void 0!==o?o:[]){r.next=11;break}throw new Error("invalid menuItems");case 11:if(i.length===n.menuItems.length){r.next=13;break}throw new Error("Something Error");case 13:return u=i.flatMap((function(r,e){return n.menuItems[e].menuItemOptions.map((function(e){return{name:e.name,type:"".concat(r.type,".").concat(r.name),cost:e.cost,restaurant:t,menu_item:r.id}}))})),console.log("insert restaurantMenuOptionList: ",u),r.next=17,q.O.from("menu_item_options").insert(i.flatMap((function(r,e){return n.menuItems[e].menuItemOptions.map((function(e){return{name:e.name,type:"".concat(r.type,".").concat(r.name),cost:e.cost,restaurant:t,menu_item:r.id}}))})));case 17:if(c=r.sent,l=c.data,!c.error){r.next=22;break}throw new Error("insert menu_item_options error");case 22:if(null===l||void 0===l||l){r.next=25;break}throw new Error("invalid menuItemOptions");case 25:case"end":return r.stop()}}),r)})),function(){var e=this,n=arguments;return new Promise((function(t,a){var o=r.apply(e,n);function i(r){sr(o,t,a,i,u,"next",r)}function u(r){sr(o,t,a,i,u,"throw",r)}i(void 0)}))});return function(r){return e.apply(this,arguments)}}(),mr=n(1024),dr=n(4267),pr=n(7922),vr=n(5861),hr=n(5111),yr=n(9217),br=n(4895),xr=n(3205);function gr(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function wr(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})))),t.forEach((function(e){gr(r,e,n[e])}))}return r}var jr=function(r){var e,n=r.register,i=r.control,u=r.itemIndex,c=r.formState.errors,l=(0,O.Dq)({control:i,name:"menuItems.".concat(u,".menuItemOptions")}),s=l.fields,f=l.append,d=l.remove,p=a.useMemo((function(){return s.length>=10}),[s]),v=a.useCallback((function(){p||f({name:"",cost:0})}),[p,f]);return(0,t.jsxs)(o.Z,{children:[s.map((function(r,a){return(0,t.jsxs)(mr.Z,{className:"ml-2 flex flex-row p-2",children:[(0,t.jsx)(y.ZP,{container:!0,spacing:1,children:m.map((function(r){var o,i,l,s,f,m,d,p,v;return(0,t.jsx)(y.ZP,{item:!0,xs:6,children:(0,t.jsx)(b.Z,wr({required:r.required,label:r.label,type:r.type,fullWidth:!0,variant:"standard"},n("menuItems.".concat(u,".menuItemOptions.").concat(a,".").concat(r.key)),{error:!!(null===(o=c.menuItems)||void 0===o||null===(i=o[u])||void 0===i||null===(l=i.menuItemOptions)||void 0===l||null===(s=l[a])||void 0===s?void 0:s[r.key]),helperText:null!==(e=null===(f=c.menuItems)||void 0===f||null===(m=f[u])||void 0===m||null===(d=m.menuItemOptions)||void 0===d||null===(p=d[a])||void 0===p||null===(v=p[r.key])||void 0===v?void 0:v.message)&&void 0!==e?e:" "}))},"gird-menu-item-option.".concat(u,".menuItemOptions.").concat(a,".").concat(r.key))}))}),(0,t.jsx)(A.Z,{onClick:function(){return d(a)},children:(0,t.jsx)(br.Z,{})})]},"menu-item-option-".concat(r.id))})),!p&&(0,t.jsx)(o.Z,{className:"flex justify-center p-4 ",children:(0,t.jsx)(A.Z,{onClick:v,children:(0,t.jsx)(xr.Z,{})})})]})};function kr(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function Sr(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Zr(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})))),t.forEach((function(e){Sr(r,e,n[e])}))}return r}function Or(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,e){var n=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=n){var t,a,o=[],i=!0,u=!1;try{for(n=n.call(r);!(i=(t=n.next()).done)&&(o.push(t.value),!e||o.length!==e);i=!0);}catch(c){u=!0,a=c}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(r,e)||function(r,e){if(!r)return;if("string"===typeof r)return kr(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kr(r,e)}(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Ir=function(r){var e,n=r.register,o=r.index,i=r.control,u=r.formState,c=r.removeButtonClick,l=void 0===c?lr.G1:c,s=Or(a.useState(!1),2),m=s[0],d=s[1],p=u.errors,v=a.useMemo((function(){var r,e;return!!(null===p||void 0===p||null===(r=p.menuItems)||void 0===r||null===(e=r[o])||void 0===e?void 0:e.menuItemOptions)}),[p,o]);return(0,t.jsxs)(mr.Z,{children:[(0,t.jsxs)(dr.Z,{className:S()("flex flex-row whitespace-pre-wrap break-all"),children:[(0,t.jsxs)(C.Z,{className:"item-center flex flex-col justify-center",elevation:0,children:[(0,t.jsx)(A.Z,{size:"small",onClick:function(){return d((function(r){return!r}))},children:m?(0,t.jsx)(yr.Z,{}):(0,t.jsx)(hr.Z,{})}),(0,t.jsx)(E.Z,{error:!0,className:"!text-center",children:v?"*":" "})]}),(0,t.jsx)(P.Z,Zr({size:"small",id:"hidden"},n("menuItems.".concat(o,".hidden")))),(0,t.jsx)(y.ZP,{container:!0,spacing:1,children:f.map((function(r){var a,i,u,c,l;return(0,t.jsx)(y.ZP,{item:!0,xs:12,sm:4,children:(0,t.jsx)(b.Z,Zr({required:r.required,label:r.label,type:r.type,fullWidth:!0,variant:"standard"},n("menuItems.".concat(o,".").concat(r.key)),{error:!!(null===(a=p.menuItems)||void 0===a||null===(i=a[o])||void 0===i?void 0:i[r.key]),helperText:null!==(e=null===(u=p.menuItems)||void 0===u||null===(c=u[o])||void 0===c||null===(l=c[r.key])||void 0===l?void 0:l.message)&&void 0!==e?e:" "}))},"gird-menu-items.".concat(o,".").concat(r.key))}))}),(0,t.jsx)(A.Z,{disabled:!o,onClick:l,className:S()(o?"opacity-100":"opacity-0"),children:(0,t.jsx)(br.Z,{})})]}),(0,t.jsx)(pr.Z,{in:m,timeout:"auto",unmountOnExit:!0,children:(0,t.jsxs)(mr.Z,{className:"m-2",children:[(0,t.jsx)(vr.Z,{variant:"h4",className:"p-2",children:"Options"}),(0,t.jsx)(jr,{register:n,control:i,itemIndex:o,formState:u})]})})]})},Ar=function(r){var e=r.register,n=r.control,i=r.formState,u=(0,O.Dq)({control:n,name:"menuItems"}),c=u.fields,l=u.append,s=u.remove,f=a.useMemo((function(){return c.length>=10}),[c]),m=a.useCallback((function(){f||l({hidden:!1,name:"",cost:0,type:""})}),[f,l]);return(0,t.jsxs)(o.Z,{children:[c.map((function(r,a){return(0,t.jsx)(Ir,{register:e,control:n,index:a,formState:i,removeButtonClick:function(){return s(a)}},"menu-items-".concat(r.id))})),!f&&(0,t.jsx)(o.Z,{className:"flex justify-center p-4 ",children:(0,t.jsx)(A.Z,{onClick:m,children:(0,t.jsx)(R.Z,{})})})]})};function Cr(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function Pr(r,e,n,t,a,o,i){try{var u=r[o](i),c=u.value}catch(l){return void n(l)}u.done?e(c):Promise.resolve(c).then(t,a)}function Er(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,e){var n=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=n){var t,a,o=[],i=!0,u=!1;try{for(n=n.call(r);!(i=(t=n.next()).done)&&(o.push(t.value),!e||o.length!==e);i=!0);}catch(c){u=!0,a=c}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(r,e)||function(r,e){if(!r)return;if("string"===typeof r)return Cr(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Cr(r,e)}(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Nr={menuItems:[{hidden:!1,name:"",cost:0,type:"",menuItemOptions:[{name:"",cost:0}]}]},Mr=Z.Ry().shape({menuItems:Z.IX().of(Z.Ry().shape({hidden:Z.O7().required("Something Error"),name:Z.Z_().required("\u4e0d\u53ef\u70ba\u7a7a").min(2,"\u592a\u5c112~"),cost:Z.Rx().transform((function(r){if(!isNaN(r)&&r%5===0&&0!==r)return r})).positive('"\u6b63"\u6574\u6578').max(200,"\u592a\u80fd\u5403200!!").required("\u4f60\u61c25\u7684\u500d\u6578\uff1f"),type:Z.Z_().when("menuItemOptions",{is:function(r){return Array.isArray(r)&&r.length>0},then:Z.Z_().required("Required for Options").min(2,"\u592a\u5c112~")}),menuItemOptions:Z.IX().of(Z.Ry().shape({name:Z.Z_().required("\u4e0d\u53ef\u70ba\u7a7a").min(2,"\u592a\u5c112~"),cost:Z.Rx().transform((function(r){return isNaN(r)||r%5!==0?void 0:r})).required("\u4f60\u61c25\u7684\u500d\u6578\uff1f").positive('"\u6b63"\u6574\u6578').max(200,"\u592a\u80fd\u5403200!!")}))}))}),_r=function(r){var e=r.restaurantId,n=Er(a.useState(!1),2),i=n[0],u=n[1],c=(0,O.cI)({defaultValues:Nr,resolver:(0,I.X)(Mr)}),l=c.control,s=c.reset,f=c.register,m=c.handleSubmit,d=c.formState;return(0,t.jsxs)(C.Z,{className:"p-2",children:[(0,t.jsx)(o.Z,{children:(0,t.jsx)(Ar,{control:l,register:f,formState:d})}),(0,t.jsx)(N.Z,{loading:i,className:"xs:w-auto !mt-2 w-full",variant:"contained",type:"submit",onClick:m(function(){var r,n=(r=j().mark((function r(n){return j().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!i){r.next=2;break}return r.abrupt("return");case 2:return u(!0),r.prev=3,r.next=6,fr({restaurantMenuList:n,restaurantId:e});case 6:return s(),r.next=9,(0,lr._v)(2e3);case 9:r.next=14;break;case 11:r.prev=11,r.t0=r.catch(3),console.log("asyncCreateRestaurants error");case 14:u(!1);case 15:case"end":return r.stop()}}),r,null,[[3,11]])})),function(){var e=this,n=arguments;return new Promise((function(t,a){var o=r.apply(e,n);function i(r){Pr(o,t,a,i,u,"next",r)}function u(r){Pr(o,t,a,i,u,"throw",r)}i(void 0)}))});return function(r){return n.apply(this,arguments)}}()),children:"CREATE"})]})},Lr=function(r){var e=r.selectRestauramtMenu,n=r.clearCallback;return(0,t.jsxs)(C.Z,{className:"p-2",children:[(0,t.jsx)(_.Z,{onClick:function(){return n()},children:"Clear"}),(0,t.jsx)(o.Z,{children:"CreateSelectRestaurantMenuOptionListForm >> ".concat(e.id,".").concat(e.name)})]})},Tr=n(4564);function Rr(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function Ur(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,e){var n=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=n){var t,a,o=[],i=!0,u=!1;try{for(n=n.call(r);!(i=(t=n.next()).done)&&(o.push(t.value),!e||o.length!==e);i=!0);}catch(c){u=!0,a=c}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(r,e)||function(r,e){if(!r)return;if("string"===typeof r)return Rr(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rr(r,e)}(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var qr=function(r){var e=r.restaurantMenu,n=r.selectCallback,o=Ur(a.useState(null),2),i=o[0],u=o[1],c=Boolean(i),l=c?"simple-popover":void 0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(or.Z,{onClick:function(r){u(r.currentTarget)},role:"checkbox",tabIndex:-1,children:s.map((function(r){var n=e[r];return(0,t.jsx)(ir.Z,{children:n&&n.toString()},"Menu-item-schema-td-".concat(r))}))},"restaurant-menu-".concat(e.id)),(0,t.jsxs)(Tr.ZP,{id:l,open:c,anchorEl:i,anchorOrigin:{vertical:"top",horizontal:"left"},children:[(0,t.jsx)(_.Z,{onClick:function(){u(null),null===n||void 0===n||n()},children:"Select"}),(0,t.jsx)(_.Z,{onClick:function(){u(null)},children:"Close"})]})]})};function Dr(r,e,n,t,a,o,i){try{var u=r[o](i),c=u.value}catch(l){return void n(l)}u.done?e(c):Promise.resolve(c).then(t,a)}var $r=function(){var r,e=(r=j().mark((function r(e){var n,t,a;return j().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,q.O.from("menu_items").select().eq("restaurant",e);case 2:if(n=r.sent,t=n.data,!(a=n.error)){r.next=7;break}throw a;case 7:if(t){r.next=9;break}throw new Error("no menu_item list");case 9:return r.abrupt("return",t);case 10:case"end":return r.stop()}}),r)})),function(){var e=this,n=arguments;return new Promise((function(t,a){var o=r.apply(e,n);function i(r){Dr(o,t,a,i,u,"next",r)}function u(r){Dr(o,t,a,i,u,"throw",r)}i(void 0)}))});return function(r){return e.apply(this,arguments)}}();function Br(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function Fr(r,e,n,t,a,o,i){try{var u=r[o](i),c=u.value}catch(l){return void n(l)}u.done?e(c):Promise.resolve(c).then(t,a)}function Xr(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,e){var n=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=n){var t,a,o=[],i=!0,u=!1;try{for(n=n.call(r);!(i=(t=n.next()).done)&&(o.push(t.value),!e||o.length!==e);i=!0);}catch(c){u=!0,a=c}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(r,e)||function(r,e){if(!r)return;if("string"===typeof r)return Br(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Br(r,e)}(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var zr=function(){var r=Xr(a.useState(!1),2),e=r[0],n=r[1],t=a.useCallback((function(r){var t=r.asyncCallback,a=r.resultCallback;(function(){var r,o=(r=j().mark((function r(){var o;return j().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!e){r.next=3;break}return a({blockByIsLoading:!0}),r.abrupt("return");case 3:return n(!0),r.prev=4,r.next=7,t();case 7:o=r.sent,a({blockByIsLoading:!1,result:o}),r.next=14;break;case 11:r.prev=11,r.t0=r.catch(4),a({blockByIsLoading:!1,error:r.t0});case 14:n(!1);case 15:case"end":return r.stop()}}),r,null,[[4,11]])})),function(){var e=this,n=arguments;return new Promise((function(t,a){var o=r.apply(e,n);function i(r){Fr(o,t,a,i,u,"next",r)}function u(r){Fr(o,t,a,i,u,"throw",r)}i(void 0)}))});return function(){return o.apply(this,arguments)}})()()}),[e,n]);return{isLoading:e,doAsyncFetchData:t}},Gr=n(9664);function Vr(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function Wr(r,e,n,t,a,o,i){try{var u=r[o](i),c=u.value}catch(l){return void n(l)}u.done?e(c):Promise.resolve(c).then(t,a)}function Hr(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,e){var n=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=n){var t,a,o=[],i=!0,u=!1;try{for(n=n.call(r);!(i=(t=n.next()).done)&&(o.push(t.value),!e||o.length!==e);i=!0);}catch(c){u=!0,a=c}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(r,e)||Kr(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jr(r){return function(r){if(Array.isArray(r))return Vr(r)}(r)||function(r){if("undefined"!==typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||Kr(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kr(r,e){if(r){if("string"===typeof r)return Vr(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vr(r,e):void 0}}var Qr=function(r){var e=Hr(a.useState(!0),2),n=e[0],t=e[1],o=Hr(a.useState([]),2),i=o[0],u=o[1],c=zr(),l=c.isLoading,s=c.doAsyncFetchData,f=a.useCallback((function(){var e=function(){var e,n=(e=j().mark((function e(){var n;return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$r(r);case 3:n=e.sent,u(n),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var r=this,n=arguments;return new Promise((function(t,a){var o=e.apply(r,n);function i(r){Wr(o,t,a,i,u,"next",r)}function u(r){Wr(o,t,a,i,u,"throw",r)}i(void 0)}))});return function(){return n.apply(this,arguments)}}();s({asyncCallback:e,resultCallback:function(r){var e=r.blockByIsLoading;console.log("asyncFetchRestaurantMenuList blockByIsLoading: ",e)}})}),[r,s]);a.useEffect((function(){t(!1)}),[r]),a.useEffect((function(){n||(t(!0),f())}),[n,f]);var m=a.useCallback((function(e){if(!e.errors){var n=e.new;n&&n.restaurant===r&&u((function(r){return Jr(r).concat([n])}))}}),[r]),d=a.useCallback((function(r){var e;if(!r.errors){var n=null===(e=r.old)||void 0===e?void 0:e.id;if(n&&!(n<=0)){var t=r.new;t&&u((function(r){return r.map((function(r){return r.id===n?t:r}))}))}}}),[]),p=a.useCallback((function(r){var e;if(!r.errors){var n=null===(e=r.old)||void 0===e?void 0:e.id;n&&(n<=0||u((function(r){return r.filter((function(r){return r.id!==n}))})))}}),[]);return(0,Gr.Z)({path:"menu_items",insertCallback:m,updateCallback:d,deleteCallback:p}),{isLoading:l,restaurantMenus:i}};function Yr(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function re(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,e){var n=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=n){var t,a,o=[],i=!0,u=!1;try{for(n=n.call(r);!(i=(t=n.next()).done)&&(o.push(t.value),!e||o.length!==e);i=!0);}catch(c){u=!0,a=c}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(r,e)||function(r,e){if(!r)return;if("string"===typeof r)return Yr(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yr(r,e)}(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ee=function(r){var e=r.restaurantId,n=re(a.useState(0),2),i=n[0],u=n[1],c=re(a.useState(5),2),l=c[0],f=c[1],m=re(a.useState(void 0),2),d=m[0],p=m[1],v=Qr(e),h=v.isLoading,y=v.restaurantMenus;return h?(0,t.jsx)(o.Z,{children:"Loading..."}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(C.Z,{className:"w-full overflow-hidden",children:[(0,t.jsx)(nr.Z,{className:"max-h-[28rem]",children:(0,t.jsxs)(tr.Z,{stickyHeader:!0,"aria-label":"sticky table",children:[(0,t.jsx)(ar.Z,{children:(0,t.jsx)(or.Z,{children:s.map((function(r){return(0,t.jsx)(ir.Z,{children:r},"Menu-item-schema-tr-".concat(r))}))})}),(0,t.jsx)(ur.Z,{children:y.slice(i*l,i*l+l).map((function(r){return(0,t.jsx)(qr,{restaurantMenu:r,selectCallback:function(){return p(r)}},"restaurant-menu-".concat(r.id))}))})]})}),(0,t.jsx)(cr.Z,{rowsPerPageOptions:[5,10,25],component:"div",count:y.length,rowsPerPage:l,page:i,onPageChange:function(r,e){u(e)},onRowsPerPageChange:function(r){f(+r.target.value),u(0)}})]}),(0,t.jsx)(o.Z,{mt:2,children:d?(0,t.jsx)(Lr,{selectRestauramtMenu:d,clearCallback:function(){return p(void 0)}}):(0,t.jsx)(_r,{restaurantId:e})})]})};function ne(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function te(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function ae(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,e){var n=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=n){var t,a,o=[],i=!0,u=!1;try{for(n=n.call(r);!(i=(t=n.next()).done)&&(o.push(t.value),!e||o.length!==e);i=!0);}catch(c){u=!0,a=c}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(r,e)||function(r,e){if(!r)return;if("string"===typeof r)return ne(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ne(r,e)}(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var oe=function(){var r=ae(a.useState(null),2),e=r[0],n=r[1],i=(0,g.Z)(),u=i.isInit,c=i.isLoading,l=i.error,s=i.restaurants;return u||c?(0,t.jsx)(o.Z,{children:"Loading..."}):l?(0,t.jsx)(o.Z,{children:"get Error"}):(0,t.jsx)(o.Z,{children:(0,t.jsxs)(y.ZP,{container:!0,spacing:1,children:[(0,t.jsx)(y.ZP,{className:"!my-auto",item:!0,xs:8,children:(0,t.jsx)(x.Z,{onChange:function(r,e){return n(e)},value:e,disablePortal:!0,id:"choose-restaurant",options:s,getOptionLabel:function(r){return"".concat(r.id," ").concat(r.name)},renderInput:function(r){return(0,t.jsx)(b.Z,function(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})))),t.forEach((function(e){te(r,e,n[e])}))}return r}({},r,{label:"restaurant"}))}})}),e?(0,t.jsx)(y.ZP,{item:!0,xs:12,children:(0,t.jsx)(ee,{restaurantId:e.id})}):(0,t.jsx)(y.ZP,{item:!0,xs:12,children:(0,t.jsx)(er,{})})]})})},ie=function(){return(0,t.jsx)(h,{children:(0,t.jsx)(oe,{})})}},7970:function(r,e,n){"use strict";n.d(e,{Z:function(){return v}});var t=n(7294),a=n(4051),o=n.n(a),i=n(3298);function u(r,e,n,t,a,o,i){try{var u=r[o](i),c=u.value}catch(l){return void n(l)}u.done?e(c):Promise.resolve(c).then(t,a)}var c=function(){var r,e=(r=o().mark((function r(){var e,n,t;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,i.O.from("restaurants").select();case 2:if(e=r.sent,n=e.data,!(t=e.error)){r.next=7;break}throw t;case 7:if(n){r.next=9;break}throw new Error("no restaurant list");case 9:return r.abrupt("return",n);case 10:case"end":return r.stop()}}),r)})),function(){var e=this,n=arguments;return new Promise((function(t,a){var o=r.apply(e,n);function i(r){u(o,t,a,i,c,"next",r)}function c(r){u(o,t,a,i,c,"throw",r)}i(void 0)}))});return function(){return e.apply(this,arguments)}}(),l=n(301),s=n(9664);function f(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function m(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,e){var n=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=n){var t,a,o=[],i=!0,u=!1;try{for(n=n.call(r);!(i=(t=n.next()).done)&&(o.push(t.value),!e||o.length!==e);i=!0);}catch(c){u=!0,a=c}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(r,e)||p(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(r){return function(r){if(Array.isArray(r))return f(r)}(r)||function(r){if("undefined"!==typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||p(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(r,e){if(r){if("string"===typeof r)return f(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(r,e):void 0}}var v=function(){var r=m(t.useState([]),2),e=r[0],n=r[1],a=(0,l.Z)({asyncCallback:c}),o=a.isInit,i=a.isLoading,u=a.error,f=a.recall,p=a.result,v=t.useCallback((function(r){if(!r.errors){var t=r.new;t&&n(d(e).concat([t]))}}),[e]),h=t.useCallback((function(r){var t;if(!r.errors){var a=null===(t=r.old)||void 0===t?void 0:t.id;if(a&&!(a<=0)){var o=r.new;if(o){var i=e.map((function(r){return r.id===a?o:r}));n(i)}}}}),[e]),y=t.useCallback((function(r){var t;if(!r.errors){var a=null===(t=r.old)||void 0===t?void 0:t.id;a&&(a<=0||n(e.filter((function(r){return r.id!==a}))))}}),[e]);return(0,s.Z)({path:"restaurants",insertCallback:v,updateCallback:h,deleteCallback:y}),t.useEffect((function(){n(p||[])}),[p]),{isInit:o,isLoading:i,error:u,recall:f,restaurants:e}}},1676:function(r,e,n){"use strict";n.d(e,{Z:function(){return f}});var t=n(7294),a=n(4051),o=n.n(a),i=n(3298);function u(r,e,n,t,a,o,i){try{var u=r[o](i),c=u.value}catch(l){return void n(l)}u.done?e(c):Promise.resolve(c).then(t,a)}function c(r){return function(){var e=this,n=arguments;return new Promise((function(t,a){var o=r.apply(e,n);function i(r){u(o,t,a,i,c,"next",r)}function c(r){u(o,t,a,i,c,"throw",r)}i(void 0)}))}}var l=function(){var r=c(o().mark((function r(){var e,n,t,a;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,i.O.storage.from("menus").list("restaurant");case 2:if(e=r.sent,n=e.data,!(t=e.error)){r.next=7;break}throw t;case 7:if(n){r.next=9;break}throw new Error("no menus");case 9:return r.next=11,Promise.all(n.map(function(){var r=c(o().mark((function r(e){var n,t,a;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.name){r.next=2;break}throw new Error("no menu name");case 2:return r.next=4,i.O.storage.from("menus").getPublicUrl("restaurant/"+e.name);case 4:if(n=r.sent,t=n.data,!(a=n.error)){r.next=9;break}throw a;case 9:if(t){r.next=11;break}throw new Error("no publicUrl");case 11:return r.abrupt("return",{id:e.id,name:e.name,publicURL:t.publicURL});case 12:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()));case 11:return a=r.sent,r.abrupt("return",a);case 13:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),s=n(301),f=function(){var r=(0,s.Z)({asyncCallback:l,customErrorCallback:function(){return new Error("Custom")}}),e=r.isInit,n=r.isLoading,a=r.error,o=r.result,i=r.recall;return{isInit:e,isLoading:n,error:a,storageMenus:t.useMemo((function(){return o||[]}),[o]),recall:i}}},9664:function(r,e,n){"use strict";var t=n(7294),a=n(3298),o=n(1622);e.Z=function(r){var e=r.path,n=r.insertCallback,i=void 0===n?o.G1:n,u=r.updateCallback,c=void 0===u?o.G1:u,l=r.deleteCallback,s=void 0===l?o.G1:l;return t.useEffect((function(){var r=a.O.from(e).on("INSERT",i).on("UPDATE",c).on("DELETE",s).subscribe();return function(){a.O.removeSubscription(r)}}),[e,i,c,s]),{}}}},function(r){r.O(0,[240,245,177,83,714,180,774,888,179],(function(){return e=2388,r(r.s=e);var e}));var e=r.O();_N_E=e}]);